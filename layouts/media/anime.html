{{ define "main" }}
<div class="media-page">
    <div class="index-content">
        {{ with .Content }}
        {{ . }}
        {{ end }}
    </div>

    {{ $data := $.Site.Data.anime }}
    {{ if $data }}
    <div class="page-stats">
        <span class="stat-item">{{ $data.totalCount }} titles</span>
        <span class="stat-item">
            <a href="https://anilist.co/user/{{ $data.username }}/animelist" target="_blank" rel="noopener">
                AniList ↗
            </a>
        </span>
    </div>

    {{ range $data.categories }}
    <section class="media-section">
        <h2 class="section-title">
            {{ .displayName }}
            <span class="section-count">({{ .count }})</span>
        </h2>
        <div class="media-grid">
            {{ range .entries }}
            <a href="{{ .url }}" target="_blank" rel="noopener" class="media-card" title="{{ .title }}">
                <div class="media-cover">
                    <img src="{{ .coverImage }}" alt="{{ .title }}" loading="lazy" />
                    {{ if gt .score 0 }}
                    <span class="media-score">★ {{ .score }}</span>
                    {{ end }}
                </div>
                <div class="media-info">
                    <h3 class="media-title">{{ .title }}</h3>
                    <div class="media-progress">
                        {{ .progress }}{{ with .episodes }}/{{ . }}{{ end }} eps
                    </div>
                </div>
            </a>
            {{ end }}
        </div>
    </section>
    {{ end }}
    {{ else }}
    <div class="no-data">
        <p>No anime data available yet.</p>
    </div>
    {{ end }}
</div>
{{ end }}